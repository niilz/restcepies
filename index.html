<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>Rezepte macher</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" media="screen" href="main.css" />
</head>
<body>
    <header>
        <h1>Rezeptmaker</h1>
        <nav class="nav">
            <ul>
                <li>home</li>
                <li>about</li>
                <li>log in</li>
            </ul>
        </nav>
    </header>

    <div>
        <form class="form">
            <select class="select" name="einkaufsliste" form="einkaufsform">
                <option value="tomaten">Tomaten</option>
                <option value="salat">Salat</option>
                <option value="fleisch">Fleisch</option>
                <option value="fisch">Fisch</option>
            </select>
            <button class="button">Gib Rezept</button>
        </form>
    </div>

    <section class="view">

    </section>
    
    <script>
        
        let zutat = document.querySelector(".select").value
        let baseUrlR = "http://food2fork.com/api/search?key="
        let baseUrlZ = "http://food2fork.com/api/get?key="

        let apiKey = jsonfile => fetch(jsonfile)
            .then(res => res.json())
            .then(json => (json[0].apiKey))

        let fetchRezepte = apiKey => fetch(baseUrlR + apiKey + "q=shredded%20chicken",{
            method: "GET",
            mode: "cors",
            })
            .then(response => response.json())
            .then(json => json.recipes.map(num => [num.recipe_id, num.title]))
            .then(pair => pair.forEach(r => fetchZutaten(r[0], apiKey)))
            .catch(err => console.log(err))
        
        let fetchZutaten = (id, apiKey) => {
            let url = baseUrlZ + apiKey + "rId=" + id.toString()
            fetch(url,{
            method: "GET",
            mode: "cors",
            })
            .then(response => response.json())
            .then(json => json.recipe)
            .then(recipe => console.log(recipe.image_url, recipe.ingredients))
            .catch(err => console.log(err))
        }

        apiKey("config.json")
        .then(key => fetchRezepte(key))
        

        // function display(rezept) => {
        //     for()
        //     let view = document.querySelector(".view")
        //     let para = document.createElement("p")
        //     let text = document.createTextNode(t)
        //     para.appendChild(text)
        //     view.appendChild(para)
        // }  


        //let button = document.querySelector(".button").addEventListener("click", display)
   
    </script>
</body>
</html>